<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>forum_discuss</title>
  <link rel="stylesheet" href="./bootstrap/bootstrap-grid.min.css" />
  <link rel="stylesheet" href="./css/app_public.css" />
  <link rel="stylesheet" href="./css/pages_scss/forum/forum.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://kit.fontawesome.com/d18b20bddd.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.11/vue.js"></script>
</head>

<body>

  @@include('app/header.html')
  <div id="forum_discuss" class="container-fluid">
    <div class="wrap row">
      <div class="side_wrap col-lg-3">
        <div class="dis_side main_side_bar">
          <ul>
            <li @click="search('實作型')">
              <a href="#"><span></span>實作型</a>
            </li>
            <li @click="search('研究型')">
              <a href="#"><span></span>研究型</a>
            </li>
            <li @click="search('文藝型')">
              <a href="#"><span></span>文藝型</a>
            </li>
            <li @click="search('社會型')">
              <a href="#"><span></span>社會型</a>
            </li>
            <li @click="search('企業型')">
              <a href="#"><span></span>企業型</a>
            </li>
            <li @click="search('事務型')">
              <a href="#"><span></span>事務型</a>
            </li>
          </ul>
          <div class="side_bar_img">
            <img src="./img/side_bar.svg" alt="">
          </div>
        </div>
      </div>

      <div class="right_panel col-lg-9">
        <!-- 搜尋框 -->
        <div class="search_wrap">
          <div class="search_wrap_line">
            <i class="fas fa-search"></i>
            <input type="search" placeholder="請輸入關鍵字" id="text_input" v-model="filter" @keyup.enter="submit">
            <button id="search_btn" @click="searchContent()">搜尋</button>
          </div>
        </div>
        <!-- 下拉選單 -->
        <div class="select">
          <div class="select_wrap">
            <span class="dis_dropdown" @click.stop="toggleDropdown($event)" :class="{'expanded': isOpen}">
              <!-- <span class="dis_dropdown" @click.stop="toggleDropdown($event)"> -->
              <input type="radio" name="orderSelect" value="all" checked="checked" id="all" @click="setOrderType(0)" />
              <label for="all">所有分類</label>
              <input type="radio" name="orderSelect" value="popular" id="popular" @click="setOrderType(1)" />
              <label for="popular">熱門文章</label>
              <input type="radio" name="orderSelect" value="question" id="question" @click="setOrderType(2)" />
              <label for="question">問題討論</label>
              <input type="radio" name="orderSelect" value="share" id="share" @click="setOrderType(3)" />
              <label for="share">經驗分享</label>
            </span>
          </div>
        </div>

        <div class="dis_body">
          <!--瀏覽留言區-->
          <div class="tab_contents">
            <div class="msg_content" v-for="messages in searchResult">
              <div class="mem_info" @click="openContent">
                <div class="info_list">
                  <div class="img_div">
                    <img :src="messages.d_img" alt="" class="dis_img" />
                  </div>
                  <div class="dis_name">{{messages.d_name}}{{accuseIsOpen}}</div>
                  <div class="dis_date">{{messages.d_data}}</div>
                </div>
                <div class="tags_list">
                  <span class="type_tag" :style="messages.d_color">{{messages.d_type}}</span>
                  <span class="type_tag">{{messages.d_qu}}</span>
                </div>
              </div>
              <div class="msg_title open_dialog" @click="openContent">
                {{messages.d_title}}
              </div>
              <div class="msg_textarea" @click="openContent">
                {{messages.d_text}}
              </div>
              <div class="msg_btn">
                <button class="heart">
                  <i class="fas fa-heart" @click="heart_btn"></i>
                </button>
                <button class="gray_btn">
                  <i class="far fa-comment-alt"></i>
                </button>
                <button class="gray_btn" @click="collect_btn">
                  <i class="fas fa-bookmark"></i>
                </button>
                <button class="gray_btn" @click="accuse_btn">
                  <i class="fas fa-exclamation-circle"></i>
                </button>
              </div>
            </div>

            <!--頁碼-->
            <div class="pagination_block">
              <ul class="pagination">
                <li><a href="#">‹</a></li>
                <li><a href="#" class="-on">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">›</a></li>
              </ul>
            </div>
          </div>

          <a href="./forum_form.html" class="pencil_btn">
            <i class="fas fa-edit"></i>
          </a>
        </div>
      </div>
    </div>
    @@include('app/footer.html')


    <!--燈箱！！！-->
    <!--點擊留言板跳出的燈箱-->
    <div class="forum_overlay" :class="{'-open':contentIsOpen}">
      <div class="forum_checkMsg">
        <div class="close_btn">
          <button type="button" class="btn_modal_close btn_third" @click="close_openContent">
            返回
          </button>
        </div>
        <div class="feedback_wrap">
          <!--留言板內容-->
          <div class="check_content">
            <div class="mem_info">
              <div class="info_list">
                <div class="img_div">
                  <img src="./img/forum/大頭照/headshot_10.jpg" alt="" class="dis_img" />
                </div>
                <div class="dis_name">豬八戒</div>
                <div class="dis_date">2020-07-28</div>
              </div>
              <div class="tags_list">
                <span class="type_tag">實作型</span>
                <span class="type_tag">經驗分享</span>
              </div>
            </div>
            <div class="msg_title open_dialog">
              有人上過前端工程師學米私塾課嗎？
            </div>
            <div class="msg_textarea">
              覺得課程整套實在有點貴，
              而且業務死不讓我看學生作品，讓我覺得很詭異
              有人買過嗎？學起來如何呢？求經驗分享～
            </div>
            <div class="msg_btn">
              <button class="heart">
                <i class="fas fa-heart" @click="heart_btn"></i>
              </button>
              <button class="gray_btn">
                <i class="far fa-comment-alt"></i>
              </button>
              <button class="gray_btn" @click="collect_btn">
                <i class="fas fa-bookmark"></i>
              </button>
              <button class="gray_btn" @click="accuse_btn">
                <i class="fas fa-exclamation-circle"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="feedback_count">共5則回應</div>
        <!--回應留言區-->
        <div class="forum_feedback">
          <div class="feedback_content">
            <div class="info_list">
              <div class="img_div">
                <img src="./img/forum/大頭照/headshot_1.jpg" alt="" class="dis_img" />
              </div>
              <div class="dis_name">孫悟空</div>
              <div class="dis_date">2020-07-28</div>
            </div>
            <div class="msg_textarea">
              我去上過覺得還好
            </div>
            <div class="msg_btn">
              <button class="heart">
                <i class="fas fa-heart" @click="heart_btn"></i>
              </button>
              <button class="gray_btn" @click="accuse_btn">
                <i class="fas fa-exclamation-circle"></i>
              </button>
            </div>
          </div>
          <div class="feedback_content">
            <div class="info_list">
              <div class="img_div">
                <img src="./img/forum/大頭照/headshot_1.jpg" alt="" class="dis_img" />
              </div>
              <div class="dis_name">孫悟空</div>
              <div class="dis_date">2020-07-28</div>
            </div>
            <div class="msg_textarea">
              我去上過覺得還好
            </div>
            <div class="msg_btn">
              <button class="heart">
                <i class="fas fa-heart" @click="heart_btn"></i>
              </button>
              <button class="gray_btn" @click="accuse_btn">
                <i class="fas fa-exclamation-circle"></i>
              </button>
            </div>
          </div>
          <div class="feedback_content">
            <div class="info_list">
              <div class="img_div">
                <img src="./img/forum/大頭照/headshot_1.jpg" alt="" class="dis_img" />
              </div>
              <div class="dis_name">孫悟空</div>
              <div class="dis_date">2020-07-28</div>
            </div>
            <div class="msg_textarea">
              我去上過覺得還好
            </div>
            <div class="msg_btn">
              <button class="heart">
                <i class="fas fa-heart" @click="heart_btn"></i>
              </button>
              <button class="gray_btn" @click="accuse_btn">
                <i class="fas fa-exclamation-circle"></i>
              </button>
            </div>
          </div>

          <div class="leave_msg_wrap">
            <div class="leave_msg">
              <textarea name="" id="send_msg" placeholder="請輸入訊息..."></textarea>
            </div>
            <div class="confirm_send_btn">
              <input type="submit" value="送出" class="btn_third" id="send_msg_btn" />
            </div>
          </div>
        </div>
      </div>
    </div>


    <!--點擊檢舉跳出燈箱-->
    <div class="impeachment_overlay" :class="{'-on':accuseIsOpen}">
      <article>
        <div class="accuse_close_btn">
          <button type="button" class="impeachment_close_btn" @click="btn_modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <h3>檢舉這篇文章的原因？</h3>
        <div class="accuse_wrap">
          <p>
            <input type="radio" name="accuse" id="" />
            重傷、歧視、挑釁、謾罵他人
          </p>
          <p><input type="radio" name="accuse" id="" /> 交換個人資料</p>
          <p><input type="radio" name="accuse" id="" /> 惡意洗版、重複張貼</p>
          <p>
            <input type="radio" name="accuse" id="" />
            包含色情、露點、性騷擾之內容
          </p>
          <p>
            <input type="radio" name="accuse" id="" /> 包含廣告、商業宣傳之內容
          </p>
          <p><input type="radio" name="accuse" id="" /> 其他原因</p>
        </div>
        <div class="accuse_send_btn">
          <button class="impeachment_send_btn btn_third">送出</button>
        </div>
      </article>
    </div>
  </div>

  @@include('app/script.html')

  <script>
    new Vue({
      el: "#forum_discuss",
      data() {
        return {
          information: [],
          searchResult: [],
          isOpen: false,
          filter: '',
          // orderType: 0,
          accuseIsOpen: false,
          openLight: false,
          contentIsOpen: false,
        }
      },
      mounted() {
        fetch('./json/forum.json')
          .then(res => res.json())
          .then(information => {
            this.information = information;
            this.searchResult = information;
          })
      },
      watch: {
        filter: function (value) {
          if (value.length == 0) {
            this.searchResult = this.information;
          }
        }
      },
      methods: {
        //開啟燈箱按鈕
        openContent() {
          if (this.contentIsOpen) {
            this.contentIsOpen = false
          } else {
            this.contentIsOpen = true
          }
        },
        //關閉燈箱
        close_openContent() {
          if (this.contentIsOpen) {
            this.contentIsOpen = false
          } else {
            this.contentIsOpen = true
          }
        },
        //下拉選單
        setOrderType() {
          if (orderType !== 0) {
            this.information.d_heart.sort(sortNum)
          }
        },
        //側邊欄搜尋
        search(type) {
          const result = this.information.filter(element => {
            return element.d_type == type
          });
          this.searchResult = result;
        },
        //關鍵字搜尋，點擊搜尋按鈕事件
        searchContent() {
          const keyword = this.filter;
          const result = this.information.filter(element => {
            return (element.d_title.indexOf(keyword) != -1 || element.d_text.indexOf(keyword) != -1)
            // return element.d_title == type
          });
          this.searchResult = result;
        },
        //關鍵字搜尋，點擊Enter按鈕事件
        submit() {
          this.searchContent();
        },
        //點擊標題會進入文章詳情

        //關閉檢舉燈箱
        btn_modal() {
          if (this.accuseIsOpen) {
            this.accuseIsOpen = false
          } else {
            this.accuseIsOpen = true
          }
        },
        //開啟檢舉燈箱
        accuse_btn() {
          if (this.accuseIsOpen) {
            this.accuseIsOpen = false
          } else {
            this.accuseIsOpen = true
          }
        },
        //愛心
        heart_btn(e) {
          e.target.classList.contains("colorRed")
            ? e.target.classList.remove("colorRed")
            : e.target.classList.add("colorRed");
        },
        //收藏
        collect_btn(e) {
          e.target.classList.contains("colorGray")
            ? e.target.classList.remove("colorGray")
            : e.target.classList.add("colorGray");
        },
        //下拉選單
        toggleDropdown(e) {
          e.preventDefault();
          e.stopPropagation();
          if (this.isOpen) {
            this.isOpen = false;
          } else {
            this.isOpen = true;
          }
          //下拉選單jQuery寫法
          // $('.dis_dropdown').click(function (e) {
          //   $(this).toggleClass('expanded');
          //   // debugger
          //   $('#' + $(this).attr('for')).prop('checked', true);
          // });
          // $(document).click(function () {
          //   $('.dis_dropdown').removeClass('expanded');
          // })
        },

      },
    });

  </script>
</body>

</html>